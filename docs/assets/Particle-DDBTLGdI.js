class y{constructor(i,a,r,e,t="splinter"){this.game=i,this.x=a,this.y=r,this.color=e,this.type=t,this.markedForDeletion=!1;const s=Math.random()*Math.PI*2;let h=Math.random()*100+50;this.vx=Math.cos(s)*h,this.vy=Math.sin(s)*h,this.gravity=0,this.friction=.95,t==="spark"?(this.vy=-Math.random()*100-50,this.gravity=500,this.life=.5,this.size=Math.random()*3+1):t==="splinter"?(this.gravity=0,this.life=1,this.size=Math.random()*4+2):t==="coin"?(this.state="POP",this.timer=0,this.vx=(Math.random()-.5)*300,this.vy=(Math.random()-.5)*300-200,this.gravity=800,this.life=10,this.size=8,this.friction=.9):t==="burst"?(this.life=.4,this.size=Math.random()*10+5,this.vx*=2,this.vy*=2):t==="dust"?(this.life=.5,this.size=Math.random()*8+4,this.vy=-20,this.vx*=.2,this.color="rgba(200, 200, 180, 0.5)"):(this.life=1,this.size=Math.random()*4+2),this.initialLife=this.life}update(i){this.type==="coin"?this.updateCoin(i):(this.x+=this.vx*i,this.y+=this.vy*i,this.vy+=this.gravity*i,this.vx*=this.friction,this.vy*=this.friction,this.life-=i,this.life<=0&&(this.markedForDeletion=!0))}updateCoin(i){if(this.state==="POP")this.x+=this.vx*i,this.y+=this.vy*i,this.vy+=this.gravity*i,this.y>this.game.player.y+100&&this.vy>0&&(this.vy*=-.6,this.vx*=.8),this.timer+=i,this.timer>.5&&(this.state="WAIT",this.timer=0);else if(this.state==="WAIT")this.timer+=i,this.timer>.2&&(this.state="FLY");else if(this.state==="FLY"){const e=40-this.x,t=40-this.y,s=Math.sqrt(e*e+t*t);if(s<30){this.markedForDeletion=!0;const l=this.value||1;this.game.addGold(l);return}const h=1500;this.x+=e/s*h*i,this.y+=t/s*h*i}}draw(i){if(i.save(),i.globalAlpha=Math.max(0,this.life/this.initialLife),this.type==="coin"&&(i.globalAlpha=1),this.game.assets.particles){const a=this.game.assets.particles,r=a.width/4,e=a.height;let t=0,s=!0;this.type==="coin"?(t=0,this.size=20,s=!1):this.type==="blood"||this.type==="splinter"&&this.color==="#cc0000"?(t=1,this.size=15):this.type==="smoke"||this.type==="dust"||this.type==="burst"&&this.color!=="#cc0000"?(t=2,this.size=20):this.type==="splinter"?(t=3,this.size=15):t=0;const h=this.x,l=this.y,n=this.size,f=this.size;i.translate(h,l),s&&i.rotate(this.game.lastTime*.005+h),i.drawImage(a,t*r,0,r,e,-n/2,-f/2,n,f)}else i.fillStyle=this.color,i.beginPath(),i.arc(this.x,this.y,this.size,0,Math.PI*2),i.fill();i.restore()}}function c(o,i,a,r,e,t){const s=[];for(let h=0;h<e;h++){const l=new y(o,i,a,r,t);o.particles.push(l),s.push(l)}return s}export{y as Particle,c as spawnParticles};
